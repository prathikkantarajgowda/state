# state population data 1990 (NHGIS)

library(tidyverse)

state_1990 <- 
  read_csv("data/1990/nhgis0040_ds120_1990_state.csv") %>% 
  as_tibble() %>%
  mutate(year = YEAR, state = STATE) %>% 
  pivot_longer(cols = starts_with("ET4"),
               names_to = "demographic") %>%
  mutate(demographic = (parse_number(substr(demographic, 4, 6))),
         age_num = demographic %% 31,
         gender_num = demographic %% 62) %>% 
  transmute(country = "United States", 
            state,
            sex = ifelse(gender_num == 0 | gender_num > 31, 
                            "female", "male"),
            race = ifelse(between(demographic, 1, 62), "white", 
                          ifelse(between(demographic, 63, 124), "black",
                                 ifelse(between(demographic, 125, 186), "native",
                                        ifelse(between(demographic, 187, 248), "aapi",
                                               "other")))),
            slave_status = "NA",
            age = case_when(age_num == 0 ~ "85_and_over",
                            age_num == 1 ~ "0_to_1",
                            age_num == 2 ~ "1_to_2",
                            age_num == 3 ~ "3_to_4",
                            age_num == 4 ~ "5",
                            age_num == 5 ~ "6",
                            age_num == 6 ~ "7_to_9",
                            age_num == 7 ~ "10_to_11",
                            age_num == 8 ~ "12_to_13",
                            age_num == 9 ~ "14",
                            age_num == 10 ~ "15",
                            age_num == 11 ~ "16",
                            age_num == 12 ~ "17",
                            age_num == 13 ~ "18",
                            age_num == 14 ~ "19",
                            age_num == 15 ~ "20",
                            age_num == 16 ~ "21",
                            age_num == 17 ~ "22_to_24",
                            age_num == 18 ~ "25_to_29",
                            age_num == 19 ~ "30_to_34",
                            age_num == 20 ~ "35_to_39",
                            age_num == 21 ~ "40_to_44",
                            age_num == 22 ~ "45_to_49",
                            age_num == 23 ~ "50_to_54",
                            age_num == 24 ~ "55_to_59",
                            age_num == 25 ~ "50_to_61",
                            age_num == 26 ~ "62_to_64",
                            age_num == 27 ~ "65_to_69",
                            age_num == 28 ~ "70_to_74",
                            age_num == 29 ~ "75_to_79",
                            age_num == 30 ~ "80_to_84"),
            year = 1990,
            statistic = "population",
            value,
            source = "INSERTSOURCENAMEHERE",
            notes = "generated by Prathik's R project here: https://github.com/prathikkantarajgowda/state",
            personentered = "Prathik", 
            complete = "")